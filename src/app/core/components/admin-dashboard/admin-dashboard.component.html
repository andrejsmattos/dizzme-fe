<div class="container-fluid admin-dashboard">
  <!-- Cabeçalho -->
  <div class="row mb-4">
    <div class="col-12">
      <h1 class="h3 mb-1">Painel do Administrador</h1>
      <p class="text-muted">Visão geral e gerenciamento do sistema.</p>
    </div>
  </div>

  <!-- Cards de Estatísticas -->
  <div class="row mb-4" *ngIf="!isLoading">
    <div class="col-md-6 col-lg-4 mb-3">
      <div class="card border-0 shadow-sm">
        <div class="card-body d-flex align-items-center">
          <div class="bg-primary bg-opacity-10 p-3 rounded-circle me-3">
            <i class="bi bi-people-fill text-primary fs-4"></i>
          </div>
          <div>
            <h3 class="mb-1">{{ totalUsers }}</h3>
            <p class="text-muted small mb-0">Usuários Registrados</p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4 mb-3">
      <div class="card border-0 shadow-sm">
        <div class="card-body d-flex align-items-center">
          <div class="bg-success bg-opacity-10 p-3 rounded-circle me-3">
            <i class="bi bi-card-checklist text-success fs-4"></i>
          </div>
          <div>
            <h3 class="mb-1">{{ totalSurveys }}</h3>
            <p class="text-muted small mb-0">Pesquisas Criadas</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabela de Gerenciamento de Usuários -->
  <div class="row">
    <div class="col-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-white border-0">
          <h6 class="mb-0">Gerenciamento de Usuários</h6>
        </div>
        <div class="card-body">
          <div *ngIf="isLoading" class="text-center py-4">
            <div class="spinner-border text-primary"></div>
          </div>
          <div *ngIf="!isLoading && users.length > 0" class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Nome</th>
                  <th>E-mail</th>
                  <th>Role</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of users">
                  <td>{{ user.name }}</td>
                  <td>{{ user.email }}</td>
                  <td>
                    <span class="badge bg-secondary">{{ user.role }}</span>
                  </td>
                  <td>
                    <button
                      class="btn btn-sm btn-outline-primary"
                      (click)="editUser(user)"
                    >
                      <i class="bi bi-pencil"></i> Editar
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Edição de Usuário -->
  <div
    *ngIf="editingUser"
    class="modal fade show d-block"
    tabindex="-1"
    style="background: rgba(0, 0, 0, 0.3)"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Editar Usuário</h5>
          <button
            type="button"
            class="btn-close"
            (click)="cancelEdit()"
          ></button>
        </div>
        <div class="modal-body">
          <form (ngSubmit)="saveUser()">
            <div class="mb-3">
              <label class="form-label" for="editUserName">Nome</label>
              <input
                id="editUserName"
                class="form-control"
                [(ngModel)]="editUserData.name"
                name="name"
                required
              />
            </div>
            <div class="mb-3">
              <label class="form-label" for="editUserEmail">E-mail</label>
              <input
                id="editUserEmail"
                class="form-control"
                [(ngModel)]="editUserData.email"
                name="email"
                required
              />
            </div>
            <div class="mb-3">
              <label class="form-label" for="editUserRole">Role</label>
              <select
                id="editUserRole"
                class="form-select"
                [(ngModel)]="editUserData.role"
                name="role"
                required
              >
                <option value="ADMIN">ADMIN</option>
                <option value="USER">USER</option>
                <option value="CLIENT">CLIENT</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button
            class="btn btn-secondary"
            (click)="cancelEdit()"
            [disabled]="isSaving"
          >
            Cancelar
          </button>
          <button
            class="btn btn-primary"
            (click)="saveUser()"
            [disabled]="isSaving"
          >
            Salvar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
